# Walkthrough: Pre-Release Work Items

## Changes Made

### 1. Push Notification Deep-Link Handler

| File | Action |
|------|--------|
| [usePushNotifications.ts](file:///Users/joshcabana/verity/verity-mobile/src/hooks/usePushNotifications.ts) | **NEW** — Hook that registers Expo push token via `POST /notifications/tokens` and routes notification taps to `Chat` or `MatchProfile` based on `deepLinkTarget` |
| [app.json](file:///Users/joshcabana/verity/verity-mobile/app.json) | Added `expo-notifications` plugin config |
| [AppNavigator.tsx](file:///Users/joshcabana/verity/verity-mobile/src/navigation/AppNavigator.tsx) | Imported hook, added `Report`/`BlockList` screen entries, mounted `usePushNotifications(navigationRef)` |
| [expo-notifications.js](file:///Users/joshcabana/verity/verity-mobile/__mocks__/expo-notifications.js) | **NEW** — Global Jest mock for `expo-notifications` |
| [push.notification.test.tsx](file:///Users/joshcabana/verity/verity-mobile/tests/__tests__/push.notification.test.tsx) | **NEW** — 5 tests covering token registration and deep-link routing |

### 2. Settings Trust & Safety Screens

| File | Action |
|------|--------|
| [ReportScreen.tsx](file:///Users/joshcabana/verity/verity-mobile/src/screens/settings/ReportScreen.tsx) | **NEW** — Report form with user ID, reason picker, details field → `POST /moderation/reports` |
| [BlockListScreen.tsx](file:///Users/joshcabana/verity/verity-mobile/src/screens/settings/BlockListScreen.tsx) | **NEW** — Blocked users list with unblock via `DELETE /moderation/blocks/:id` |
| [SettingsScreen.tsx](file:///Users/joshcabana/verity/verity-mobile/src/screens/settings/SettingsScreen.tsx) | Replaced stub alerts → navigation to `Report` and `BlockList` screens |
| [report-block.test.tsx](file:///Users/joshcabana/verity/verity-mobile/tests/__tests__/report-block.test.tsx) | **NEW** — 4 tests covering form validation, API submission, and block list display |

### 3. Release Operations Runbook

| File | Action |
|------|--------|
| [release-runbook.md](file:///Users/joshcabana/verity/docs/notes/release-runbook.md) | **NEW** — Pre-release gates, migration policy, deploy steps, rollback, post-deploy smoke |

### 4. README Documentation Alignment

| File | Action |
|------|--------|
| [README.md](file:///Users/joshcabana/verity/verity-mobile/README.md) | Fixed 5 stale statements: event name, refund logic, match visibility, mock tooling, privacy stubs |

### 5. Design & Frontend Overhaul ("Midnight Mirror")

**Theme:** Minimalist Luxury (Black / White / Gold). No profiles, just chemistry.

| Platform | File | Action |
|----------|------|--------|
| **Web** | [styles.css](file:///Users/joshcabana/verity/verity-web/src/styles.css) | **NEW** — Rebuilt from scratch with CSS variables for the black/gold palette and Inter typography. |
| **Web** | [Home.tsx](file:///Users/joshcabana/verity/verity-web/src/pages/Home.tsx) | **NEW** — Implemented "Hero Split" layout, "How It Works" cards, and Safety section (Authenticated). |
| **Web** | [Onboarding.tsx](file:///Users/joshcabana/verity/verity-web/src/pages/Onboarding.tsx) | **NEW** — Updated the public landing page to match the new design system (Unauthenticated). |
| **Mobile** | [tokens.ts](file:///Users/joshcabana/verity/verity-mobile/src/theme/tokens.ts) | Updated color tokens to match the new spec (`voidBlack`, `luxGold`, `paperWhite`). Added legacy compatibility keys. |
| **Mobile** | [HomeScreen.tsx](file:///Users/joshcabana/verity/verity-mobile/src/screens/HomeScreen.tsx) | **NEW** — Implemented sticky transparent header, SVG hero visual, and consistent luxury layout. |

#### Visual Verification
The new public landing page (`Onboarding.tsx`) running on localhost:

![Midnight Mirror Landing Page](file:///Users/joshcabana/.gemini/antigravity/brain/3f35748c-d581-4ee0-8a8a-4869521dcabf/verity_midnight_mirror_hero_1770995042656.png)

## Test Results

### Mobile Tests (`verity-mobile`)
```
Test Suites: 14 passed, 14 total
Tests:       47 passed, 47 total
Typecheck:   Passed (tsc --noEmit)
```

### Web Build (`verity-web`)
```
> vite build
✓ 136 modules transformed.
✓ built in 948ms
```

All verification steps passed. The design system is now consistent across both platforms.

## Remaining Manual Step

> [!IMPORTANT]
> Push deep-link validation on a **real device** with push entitlements is still required.
